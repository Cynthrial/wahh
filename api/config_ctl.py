from flask import  redirect, url_for, request,  Blueprint, jsonifyimport requests, jsonctl = Blueprint('ctl', __name__)@ctl.route('/choose', methods=['GET', 'POST'])def choose():    _mod = request.form.get("mod")    _id = request.form.get("id")    _value = request.form.get("value")    _value_type = request.form.get("value_type")    _action = request.form.get("action")    _debug = request.form.get('debug')    _waf_state = request.form.get('waf_state')    _waf_action = request.form.get('waf_action')    if _action == 'get':        return redirect(url_for('ctl.get', action=_action, mod=_mod, id=_id, value=_value, value_type=_value_type))    if _action == 'add':        return redirect(url_for('ctl.add', action=_action, mod=_mod, id=_id, value=_value, value_type=_value_type))    if _action == 'save':        return redirect(            url_for('ctl.save', action=_action, mod=_mod, id=_id, value=_value, value_type=_value_type, debug=_debug))    if _action == 'set':        return redirect(url_for('ctl.set', action=_action, mod=_mod, id=_id, value=_value, value_type=_value_type))    if _action == 'delete':        return redirect(url_for('ctl.delete', action=_action, mod=_mod, id=_id, value=_value, value_type=_value_type))    if _action == 'close':        return redirect(url_for('ctl.close', action=_action, mod=_mod, id=_id, value=_value, value_type=_value_type))    if _action == 'open':        return redirect(url_for('ctl.open', action=_action, mod=_mod, id=_id, value=_value, value_type=_value_type))    if _action == 'search':        return redirect(url_for('ctl.search', action=_action, mod=_mod, id=_id, value=_value, value_type=_value_type,                                waf_action=_waf_action, waf_state=_waf_state))    return "fail"@ctl.route('/get')def get():    _mod = request.args.get("mod")    _id = request.args.get("id")    if _id == 'null':        _id=''    # 当id为count_id则显示id个数    _value = request.args.get("value")    payload = {'action': 'get', 'mod': _mod, 'id': _id, 'value': _value}    url = "http://10.59.17.33:5460/api/config_dict"    result = requests.get(url, params=payload)    r = json.loads(result.text)    return jsonify(r)@ctl.route('/add')def add():    _mod = request.args.get("mod")    _id = request.args.get("id")    _type = request.args.get("content_type")    _value = request.args.get("value")    if _type != '':        _type = 'json'    payload = {'action': 'add', 'mod': _mod, 'id': _id, 'value_type': _type, 'value': _value}    url = "http://10.59.17.33:5460/api/config_dict"    result = requests.get(url, params=payload)    r = json.loads(result.text)    return jsonify(r)@ctl.route('/delete')def delete():    _mod = request.args.get("mod")    _id = request.args.get("id")    if _id == '' and _mod != '':        return "id为空很危险，你却定你在做什么的话请传入“id=null”"    if _id == "id=null":        _id = ''    # 当id为count_id则显示id个数    payload = {'action': 'del', 'mod': _mod, 'id': _id}    url = "http://10.59.17.33:5460/api/config_dict"    result = requests.get(url, params=payload)    r = json.loads(result.text)    return jsonify(r)@ctl.route('/set')def set():    _mod = request.args.get("mod")    _id = request.args.get("id")    _type = request.args.get("content_type")    _value = request.args.get("value")    if _type != '':        _type = 'json'    if _id == '' and _mod != '':        return "id为空很危险，你却定你在做什么的话请传入“id=null”"    if _id == "id=null":        _id = ''    # 当id为count_id则显示id个数    payload = {'action': 'set', 'mod': _mod, 'id': _id, 'value_type': _type, 'value': _value}    url = "http://10.59.17.33:5460/api/config_dict"    result = requests.get(url, params=payload)    r = json.loads(result.text)    return jsonify(r)@ctl.route('/save')def save():    _mod = request.args.get("mod")    _id = request.args.get("id")    _type = request.args.get("content_type")    _value = request.args.get("value")    payload = {'action': 'save', 'mod': _mod}    url = "http://10.59.17.33:5460/api/config"    result = requests.get(url, params=payload)    r = json.loads(result.text)    return jsonify(r)@ctl.route('/reload')def reload():    payload = {'action': 'reload'}    result = requests.get("http://10.59.17.33:5460/api/config", params=payload)    r = json.loads(result.text)    return jsonify(r)@ctl.route('/close')def close():    _mod = request.args.get("mod")    _id = request.args.get("id")    # if _id == '' and _mod != '':    #     return "id为空很危险，你确定你在做什么的话请传入“id=null”"    # if _id == "id=null":    #     _id = ''    payload = {'action': 'close', 'mod': _mod, 'id': _id}    url = "http://10.59.17.33:5460/api/config_dict"    result = requests.get(url, params=payload)    r = json.loads(result.text)    return jsonify(r)@ctl.route('/open')def open():    _mod = request.args.get("mod")    _id = request.args.get("id")    payload = {'action': 'open', 'mod': _mod, 'id': _id}    url = "http://10.59.17.33:5460/api/config_dict"    result = requests.get(url, params=payload)    r = json.loads(result.text)    return jsonify(r)@ctl.route('/search')def search():    _mod = request.args.get("mod")    _value = request.args.get("value")    _waf_action = request.args.get("waf_action")    _waf_state = request.args.get("waf_state")    payload = {'action': 'search', 'mod': _mod, 'value': _value, 'waf_state': _waf_state, 'waf_action': _waf_action}    url = "http://10.59.17.33:5460/api/config_dict"    result = requests.get(url, params=payload)    r = json.loads(result.text)    return jsonify(r)